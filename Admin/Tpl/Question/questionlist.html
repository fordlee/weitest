<include file="Public:header" />
<include file="Public:sidenav" />
<link rel="stylesheet" href="__PUBLIC__/static/css/mask.css">
<div class="main-content">
	<div class="breadcrumbs" id="breadcrumbs">
		<script type="text/javascript">
			try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
		</script>
		<ul class="breadcrumb">
			<li>
				<i class="icon-home home-icon"></i>
				<a href="#">题库管理</a>
			</li>
			<li class="active">详细设置</li>
		</ul><!-- .breadcrumb -->
	</div>

	<div class="page-content">
		<div class="row">
			<div class="col-xs-12">
				<table id="sample-table-1" class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th class="center">ID</th>
							<th class="center">编号</th>
							<th class="center">题目标题</th>
							<th class="center">状态</th>
						</tr>
					</thead>

					<tbody>
						<volist name="list" id="v">
						<tr>
							<td class="center">{$v.id}</td>
							<td class="center">{$v.qcode}</td>
							<td >
								<volist name="v['qd']" id="qdetail">
									<font size="5">{$qdetail.content}</font>
									[<a href="javascript:void()" onclick="addResult('{$qdetail.id}','{$qdetail.qid}', '{$qdetail.language}')">添加</a>&nbsp;<a href="{:U('Answer/editResult')}/qid/{$qdetail.qid}/qdid/{$qdetail.id}">修改</a>]
									<br>
								</volist>
								<a href="javascript:void()" onclick="addQuestion('{$v.id}')" class="btn btn-xs btn-primary">添加题目</a>
								<a href="{:U('Question/editQuestion')}/qid/{$v.id}" class="btn btn-xs btn-light">修改题目</a>
							</td>
							<td class="center">
								<form action="{:U('setStatus')}" method="post" >
									<input type="hidden" name="qid" value="{$v.id}">
									<input type="hidden" name="status" value="{$v.status}">
									<if condition="$v.status eq 1">
										<button type="submit" class="btn btn-sm btn-success">启用</button>
									<else/>
										<button type="submit" class="btn btn-sm btn-danger">关闭</button>
									</if>
								</form>
							</td>
						</tr>
					</volist>
					</tbody>
				</table>

				<div id="dialog" class="dialog" style="display:none">
		            <div class="mask"></div>
		            <div class="body">
		            	<form action="{:U('Answer/answerentrysave')}" method="post" enctype="multipart/form-data" class="form-horizontal" >
							<input type="hidden" name="qdid" id="qdid">
							<input type="hidden" name="qid" id="qid">
							<div class="form-group">
								<label class="col-sm-2 control-label no-padding-right" for="languageset">语言：</label>
								<div class="col-sm-2">
									<select id="languageset" name="languageset" disabled>
										<option value="zh">中文</option>
										<option value="en">英语</option>
										<option value="pt">葡语</option>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 control-label no-padding-right">问题：</label>
								<div class="col-sm-10">
									<input type="text" name="content" id="content" placeholder="" class="col-sm-6" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label no-padding-right">答案：</label>
								<div class="col-sm-10">
									<input type="text" name="option[]" placeholder="" class="col-sm-6" />
									<div class="col-sm-3">
									<button type="button" onclick="addAnswerPic(this)" class="btn btn-xs btn-primary">
										<i class="icon icon-plus"></i>图片
									</button>&nbsp;
									<button type="button" onclick="delTr(this)" class="btn btn-xs btn-danger"> 
										<i class="icon-minus"></i>移除
									</button>
									</div>
									<input type="file" name="answerPic[]" class="col-sm-2" style="display:none">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label no-padding-right">画图设置：</label>
								<div class="col-sm-10">
									<textarea name="optionset[]" style="margin: 0px; width: 330px; height: 200px;"></textarea>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label no-padding-right"></label>
								<div class="col-sm-10">
									<button type="button" onclick="addDia(this);" class="btn btn-sm btn-primary">
										<i class="icon icon-plus"></i>添加选项
									</button>
								</div>
							</div>
							
							<div class="form-group">
								<div class="col-sm-2">
									
								</div>
								<div class="col-sm-7">
									<input type="submit" class="btn btn-primary pull-right" value="添加">
								</div>
							</div>
						</form>
		            </div>
	        	</div>

	        	<div id="question_dialog" class="question_dialog" style="display:none">
	        		<div class="mask"></div>
	        		<div class="question_body">
	        			<form action="{:U('Question/addQuestion')}" method="post" class="form-horizontal" >
							<input type="hidden" name="qid" id="questionid">
							<div class="form-group">
								<label class="col-sm-2 control-label no-padding-right" for="languageset">语言：</label>
								<div class="col-sm-2">
									<select name="languageset">
										<option value="zh">中文</option>
										<option value="en">英语</option>
										<option value="pt">葡语</option>
									</select>
								</div>
							</div>

							<div class="form-group">
								<label class="col-sm-2 control-label no-padding-right">问题：</label>
								<div class="col-sm-10">
									<input type="text" name="content" placeholder="" class="col-sm-6" />
								</div>
							</div>
							
							<div class="form-group">
								<div class="col-sm-2">
									<input type="reset" class="btn btn-light pull-right" value="重置">
								</div>
								<div class="col-sm-7">
									<input type="submit" class="btn btn-primary pull-right" value="添加">
								</div>
							</div>
						</form>
	        		</div>
	        	</div>

			</div>
		</div>

	</div>

</div><!-- /.main-content -->
<include file="Public:footer" />
<script type="text/javascript">
$('.mask').click(function(e) {
   $('#dialog').hide();
   $('#question_dialog').hide();
   //window.location.reload();
});

function addResult(qdid,qid,language){
	var content = '{$qdetail.content}';
	$('#qdid').val(qdid);
	$('#qid').val(qid);
	$('#content').val(content);
	if(language == 'pt'){
		$('#languageset').val('pt');
	}else if(language == 'en'){
		$('#languageset').val('en');
	}else{
		$('#languageset').val('zh');
	}
	$('#dialog').show();
}

function addQuestion(qid){
	$('#questionid').val(qid);
	$('#question_dialog').show();
}

function addAnswerPic(obj){
	var _this=$(obj);
	_this.parent().next().click();
}

function addDia(obj){
	var _this=$(obj);
	var str=
	'<div class="form-group">'+
		'<label class="col-sm-2 control-label no-padding-right" >答案：</label>'+
		'<div class="col-sm-10">'+
			'<input type="text" name="option[]" placeholder="" class="col-sm-6" />'+
			'<div class="col-sm-3">'+
			'<button type="button" onclick="addAnswerPic(this)" class="btn btn-xs btn-primary">'+
				'<i class="icon icon-plus"></i>图片'+
			'</button>&nbsp;'+
			'<button type="button" onclick="delTr(this)" class="btn btn-xs btn-danger">'+ 
				'<i class="icon-minus"></i>移除'+
			'</button>'+
			'</div>'+
			'<input type="file" name="answerPic[]" class="col-sm-2" style="display:none">'+
		'</div>'+
	'</div>'+
	'<div class="form-group">'+
		'<label class="col-sm-2 control-label no-padding-right">画图设置：</label>'+
		'<div class="col-sm-10">'+
			'<textarea name="optionset[]" style="margin: 0px; width: 330px; height: 200px;"></textarea>'+
		'</div>'+
	'</div>';
	_this.parent().parent().before(str);
}

function delTr(obj){
	var _this=$(obj);
	_this.parent().parent().parent().next().remove();
	_this.parent().parent().parent().remove();
}

</script>
